<!DOCTYPE html>
<html lang="zh-CN" data-page="giffgaff">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light dark" />
    <meta name="description" content="Giffgaff eSIM å·¥å…·ï¼Œæ”¯æŒ OAuth ç™»å½•ã€MFA éªŒè¯ã€äºŒç»´ç ç”Ÿæˆä¸è®¾å¤‡æ›´æ¢ã€‚">
    
    <!-- é¢„è¿æ¥ä¼˜åŒ– -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://qrcode.show" crossorigin>
    <link rel="preconnect" href="https://api.giffgaff.com" crossorigin>
    <link rel="preconnect" href="https://id.giffgaff.com" crossorigin>
    <link rel="preconnect" href="https://publicapi.giffgaff.com" crossorigin>
    
    <!-- CSPç­–ç•¥ -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://challenges.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; font-src 'self' data: https://cdnjs.cloudflare.com; connect-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://www.google-analytics.com https://www.googletagmanager.com https://qrcode.show https://api.qrserver.com https://appapi.simyo.nl https://api.giffgaff.com https://id.giffgaff.com https://publicapi.giffgaff.com https://challenges.cloudflare.com; img-src 'self' data: https:; frame-src 'self' https://challenges.cloudflare.com;">
    
    <title>Giffgaff eSIM ç”³è¯·å·¥å…·</title>
    <link rel="manifest" href="/manifest.webmanifest">
    <meta name="theme-color" content="#ffcc00">
    <link rel="icon" href="/src/assets/favicon.ico" type="image/x-icon">
    
    <!-- å¤–éƒ¨æ ·å¼ -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/src/assets/fontawesome/all.min.css">
    
    <!-- å…±äº«è®¾è®¡ç³»ç»Ÿ -->
    <link rel="preload" href="/src/styles/design-system.css" as="style" onload="this.rel='stylesheet'">
    <link rel="preload" href="/src/styles/animations.css" as="style" onload="this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="/src/styles/design-system.css">
        <link rel="stylesheet" href="/src/styles/animations.css">
    </noscript>
    
    <!-- Giffgaffä¸“ç”¨æ ·å¼ -->
    <link rel="stylesheet" href="/src/giffgaff/styles/giffgaff-base.css">
    <link rel="stylesheet" href="/src/giffgaff/styles/giffgaff-components.css">
    <link rel="stylesheet" href="/src/giffgaff/styles/giffgaff-service-time.css">
    <link rel="stylesheet" href="/src/giffgaff/styles/giffgaff-animations.css">
    <link rel="stylesheet" href="/src/giffgaff/styles/giffgaff-responsive.css">
    
    <!-- Service Worker æ³¨å†Œ -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }
    </script>
</head>
<body aria-label="Giffgaff eSIM å·¥å…·">
    <div class="container main-container">
        <!-- åº”ç”¨å¤´éƒ¨ -->
        <div class="app-header">
            <div class="logo-container">
                <i class="fas fa-sim-card app-icon" aria-hidden="true"></i>
                <div class="app-title">
                    <span class="lang-zh">Giffgaff eSIMå·¥å…·</span>
                    <span class="lang-en">Giffgaff eSIM Tool</span>
                </div>
            </div>

            <div class="header-buttons">
                <div class="language-switcher">
                    <button id="languageSwitcher" class="lang-switch" type="button" aria-label="åˆ‡æ¢è¯­è¨€åˆ°è‹±æ–‡">ğŸŒ English</button>
                </div>
                <button class="login-btn" onclick="openTutorial()" aria-label="æŸ¥çœ‹æ•™ç¨‹">
                    <i class="fas fa-book" aria-hidden="true"></i>
                    <span class="lang-zh">æŸ¥çœ‹æ•™ç¨‹</span>
                    <span class="lang-en">View Tutorial</span>
                </button>
                <a href="https://github.com/Silentely/eSIM-Tools" target="_blank" class="github-btn" aria-label="æ‰“å¼€GitHubä»“åº“">
                    <i class="fab fa-github" aria-hidden="true"></i> GitHub
                </a>
            </div>
        </div>
        
        <!-- å¼€å¡æ¨å¹¿ -->
        <div class="promo-banner reveal">
            <div class="promo-content">
                <i class="fas fa-gift promo-icon"></i>
                <span class="promo-text">
                    <span class="lang-zh">
                        å¦‚æœæ‚¨è¿˜æ²¡æœ‰Giffgaffè´¦æˆ·ï¼Œå¯ä»¥
                        <a href="https://www.giffgaff.com/orders/affiliate/mowal44_1653194386268" target="_blank" class="promo-link">
                            ç‚¹å‡»è¿™é‡Œå¼€å¡
                        </a>
                        ï¼Œäº«å—é¢å¤–5è‹±é•‘è¯è´¹èµ é€ï¼
                    </span>
                    <span class="lang-en">
                        New to Giffgaff? 
                        <a href="https://www.giffgaff.com/orders/affiliate/mowal44_1653194386268" target="_blank" class="promo-link">
                            order here
                        </a>
                        to receive an extra Â£5 credit!
                    </span>
                </span>
            </div>
        </div>
        
        <!-- é¡µé¢æ ‡é¢˜ -->
        <div class="page-title reveal">
            <h1>
                <span class="lang-zh">Giffgaff eSIM ç”³è¯·å·¥å…·</span>
                <span class="lang-en">Giffgaff eSIM Application Tool</span>
            </h1>
            <p>
                <span class="lang-zh">å°†æ‚¨çš„å®ä½“SIMå¡æ— ç¼è½¬æ¢ä¸ºeSIM</span>
                <span class="lang-en">Convert your physical SIM to an eSIM seamlessly</span>
            </p>
            <div id="modeBadge" class="mode-badge" style="display:none" aria-live="polite">
                <i class="fas fa-exchange-alt" aria-hidden="true"></i>
                <span class="lang-zh">è®¾å¤‡æ›´æ¢æ¨¡å¼</span>
                <span class="lang-en">Device change mode</span>
            </div>
        </div>
        
        <!-- æœåŠ¡æ—¶é—´æç¤º -->
        <div id="serviceTimeAlert" class="alert mb-4 service-time-alert">
            <div class="service-time-grid">
                <div class="service-time-left">
                    <div class="service-time-header">
                        <div id="actionMessage" class="service-time-action-badge" style="display: none;"></div>
                    </div>
                    <div class="service-time-body">
                        <div class="service-time-layout">
                            <div class="service-time-icon-section">
                                <i id="serviceTimeIcon" class="fas" aria-hidden="true"></i>
                            </div>
                            <div class="service-time-content-section">
                                <div class="service-time-title">
                                    <span class="lang-zh">æœåŠ¡æ—¶é—´æé†’ï¼š</span>
                                    <span class="lang-en">Service window reminder:</span>
                                </div>
                                <div id="serviceTimeMessage" class="service-time-message">
                                    <span class="lang-zh">å½“å‰æ—¶é—´åœ¨æœåŠ¡æ—¶é—´å¤–ï¼ŒGiffgaffå®˜æ–¹åœ¨è‹±å›½æ—¶é—´04:30è‡³21:30ä¹‹é—´æä¾›SIMäº¤æ¢æœåŠ¡ã€‚</span>
                                    <span class="lang-en">Outside of service hours. Giffgaff processes SIM swaps between 04:30 and 21:30 UK time.</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="current-time-card" aria-label="å½“å‰æ—¶é—´">
                    <div class="time-card-icon">
                        <i class="fas fa-clock" aria-hidden="true"></i>
                    </div>
                    <div class="time-card-text">
                        <div class="time-card-label">
                            <span class="lang-zh">å½“å‰æ—¶é—´</span>
                            <span class="lang-en">Current time</span>
                        </div>
                        <div id="currentTime" class="time-card-value">--:--</div>
                        <div id="ukTimeHint" class="time-card-hint">
                            <span class="lang-zh">è‹±å›½æ—¶é—´ --:--</span>
                            <span class="lang-en">UK time --:--</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- çŠ¶æ€æ˜¾ç¤ºé¢æ¿ -->
        <div class="status-panel card-elevated reveal" role="status" aria-live="polite">
            <h3>
                <i class="fas fa-info-circle" aria-hidden="true"></i>
                <span class="lang-zh">å½“å‰çŠ¶æ€</span>
                <span class="lang-en">Current status</span>
            </h3>
            <div class="status-grid">
                <div class="status-item">
                    <span class="status-label">
                        <span class="lang-zh">å½“å‰æ¨¡å¼:</span>
                        <span class="lang-en">Current mode:</span>
                    </span>
                    <span id="statusMode" class="status-value connected">æ ‡å‡†æµç¨‹</span>
                </div>
                <div class="status-item">
                    <span class="status-label">
                        <span class="lang-zh">Access Token:</span>
                        <span class="lang-en">Access Token:</span>
                    </span>
                    <span id="statusAccessToken" class="status-value disconnected">æœªç™»å½•</span>
                </div>
                <div class="status-item">
                    <span class="status-label">
                        <span class="lang-zh">MFA ç­¾å:</span>
                        <span class="lang-en">MFA signature:</span>
                    </span>
                    <span id="statusMfaSignature" class="status-value disconnected">æœªéªŒè¯</span>
                </div>
                <div class="status-item">
                    <span class="status-label">
                        <span class="lang-zh">ä¼šå‘˜ID:</span>
                        <span class="lang-en">Member ID:</span>
                    </span>
                    <span id="statusMemberId" class="status-value disconnected">æœªè·å–</span>
                </div>
                <div class="status-item">
                    <span class="status-label">
                        <span class="lang-zh">eSIMçŠ¶æ€:</span>
                        <span class="lang-en">eSIM status:</span>
                    </span>
                    <span id="statusEsimStatus" class="status-value disconnected">
                        <span id="esimStatusValue"></span><br>
                        <span id="esimStatusPhoneSuffix"></span>
                    </span>
                </div>
                <div class="status-item">
                    <span class="status-label">
                        <span class="lang-zh">æ¿€æ´»ç :</span>
                        <span class="lang-en">Activation code:</span>
                    </span>
                    <span id="statusActivationCode" class="status-value disconnected">
                        <span id="activationCodeValue"></span><br>
                        <span id="activationCodeSSN"></span>
                    </span>
                </div>
                <div class="status-item">
                    <span class="status-label">
                        <span class="lang-zh">LPAå­—ç¬¦ä¸²:</span>
                        <span class="lang-en">LPA string:</span>
                    </span>
                    <span id="statusLpaString" class="status-value disconnected">æœªç”Ÿæˆ</span>
                </div>
            </div>
            <button id="clearSessionBtn" class="clear-session-btn" aria-label="æ¸…é™¤ä¼šè¯å¹¶é‡ç½®æ‰€æœ‰è¿›åº¦">
                <i class="fas fa-trash-alt" aria-hidden="true"></i>
                <span class="lang-zh">æ¸…é™¤ä¼šè¯</span>
                <span class="lang-en">Clear session</span>
            </button>
        </div>
        
        <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
        <div class="step-indicator reveal" role="list" aria-label="è¿›åº¦æ­¥éª¤">
            <div class="step active" role="listitem" aria-current="step" data-step="1">
                <div class="step-number" aria-hidden="true">1</div>
                <div class="step-text">
                    <span class="lang-zh">OAuthç™»å½•</span>
                    <span class="lang-en">OAuth login</span>
                </div>
            </div>
            <div class="step" data-step="2">
                <div class="step-number">2</div>
                <div class="step-text">
                    <span class="lang-zh">é‚®ä»¶éªŒè¯</span>
                    <span class="lang-en">Email verification</span>
                </div>
            </div>
            <div class="step" data-step="3">
                <div class="step-number">3</div>
                <div class="step-text">
                    <span class="lang-zh">ä¼šå‘˜ä¿¡æ¯</span>
                    <span class="lang-en">Member info</span>
                </div>
            </div>
            <div class="step" data-step="4">
                <div class="step-number">4</div>
                <div class="step-text">
                    <span class="lang-zh">ç”³è¯·eSIM</span>
                    <span class="lang-en">Reserve eSIM</span>
                </div>
            </div>
            <div class="step" data-step="5">
                <div class="step-number">5</div>
                <div class="step-text">
                    <span class="lang-zh">è·å–äºŒç»´ç </span>
                    <span class="lang-en">Get QR code</span>
                </div>
            </div>
        </div>
        
        <!-- æ­¥éª¤1: é€‰æ‹©ç™»å½•æ–¹å¼ -->
        <div id="step1" class="section active reveal">
            <div class="card card-elevated">
                <div class="card-header">
                    <i class="fas fa-key"></i>
                    <span class="lang-zh"> ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©ç™»å½•æ–¹å¼</span>
                    <span class="lang-en"> Step 1: Choose a login method</span>
                </div>
                <div class="card-body">
                    <p class="mb-4 lang-zh" style="font-size: 17px; color: #212529;">
                        è¯·é€‰æ‹©æ‚¨åå¥½çš„ç™»å½•æ–¹å¼ï¼š
                    </p>
                    <p class="mb-4 lang-en" style="font-size: 17px; color: #212529;">
                        Pick the login method you prefer:
                    </p>
                    
                    <div class="row row-cols-1 row-cols-md-2 g-3">
                        <div class="col">
                            <div id="oauthCard" class="card h-100" style="cursor: pointer;" role="button" tabindex="0" aria-label="é€‰æ‹© OAuth ç™»å½•">
                                <div class="card-body text-center">
                                    <i class="fas fa-shield-alt fa-3x mb-3" style="color: var(--primary);"></i>
                                    <h5>
                                        <span class="lang-zh">OAuth 2.0 ç™»å½•</span>
                                        <span class="lang-en">OAuth 2.0 login</span>
                                    </h5>
                                    <p class="text-muted">
                                        <span class="lang-zh">å®‰å…¨çš„å®˜æ–¹è®¤è¯æ–¹å¼</span>
                                        <span class="lang-en">Secure official authentication</span>
                                    </p>
                                    <small class="text-success">
                                        <span class="lang-zh">âœ“ æ¨èä½¿ç”¨</span>
                                        <span class="lang-en">âœ“ Recommended</span>
                                    </small>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div id="cookieCard" class="card h-100" style="cursor: pointer;" role="button" tabindex="0" aria-label="é€‰æ‹© Cookie ç™»å½•">
                                <div class="card-body text-center">
                                    <i class="fas fa-cookie-bite fa-3x mb-3" style="color: var(--warning);"></i>
                                    <h5>
                                        <span class="lang-zh">Cookie ç™»å½•</span>
                                        <span class="lang-en">Cookie login</span>
                                    </h5>
                                    <p class="text-muted">
                                        <span class="lang-zh">ä½¿ç”¨å·²æœ‰ç™»å½•Cookie</span>
                                        <span class="lang-en">Use an existing session cookie</span>
                                    </p>
                                    <small class="text-info">
                                        <span class="lang-zh">âœ“ å¿«é€Ÿä¾¿æ·</span>
                                        <span class="lang-en">âœ“ Quick and easy</span>
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="loginMethodStatus" class="status"></div>
                    
                    <!-- OAuthç™»å½•åŒºåŸŸ -->
                    <div id="oauthLoginSection" class="mt-4" style="display: none;">
                        <h5 class="mb-3">
                            <span class="lang-zh">OAuth 2.0 ç™»å½•</span>
                            <span class="lang-en">OAuth 2.0 login</span>
                        </h5>
                        
                        <div class="alert alert-warning mb-4">
                            <h6 class="lang-zh"><i class="fas fa-exclamation-triangle me-2"></i>å¦‚ä½•è·å–å›è°ƒURLï¼š</h6>
                            <h6 class="lang-en d-none"><i class="fas fa-exclamation-triangle me-2"></i>How to capture the callback URL:</h6>
                            <ol class="mb-2 lang-zh">
                                <li><strong>æ‰“å¼€å¼€å‘è€…å·¥å…·</strong>ï¼šæŒ‰ F12 æˆ–å³é”®é€‰æ‹©"æ£€æŸ¥"</li>
                                <li><strong>åˆ‡æ¢åˆ°"ç½‘ç»œ"æ ‡ç­¾é¡µ</strong></li>
                                <li><strong>åœ¨ç™»å½•é¡µé¢è¾“å…¥é‚®ç®±éªŒè¯ç </strong></li>
                                <li><strong>ç‚¹å‡»ç™»å½•æŒ‰é’®</strong></li>
                                <li><strong>åœ¨ç½‘ç»œé¢æ¿ä¸­æŸ¥æ‰¾</strong> <code>giffgaff://auth/callback/</code> å¼€å¤´çš„è¯·æ±‚</li>
                                <li><strong>å¤åˆ¶å®Œæ•´çš„URL</strong> å¹¶ç²˜è´´åˆ°ä¸‹æ–¹è¾“å…¥æ¡†</li>
                            </ol>
                            <ol class="mb-2 lang-en">
                                <li><strong>Open DevTools</strong>: press F12 or right-click â†’ â€œInspectâ€.</li>
                                <li><strong>Switch to the â€œNetworkâ€ tab.</strong></li>
                                <li><strong>Enter the email verification code</strong> on the login page.</li>
                                <li><strong>Click the login button.</strong></li>
                                <li><strong>Find the request</strong> starting with <code>giffgaff://auth/callback/</code> in the network list.</li>
                                <li><strong>Copy the full URL</strong> and paste it into the input field below.</li>
                            </ol>
                            <p class="mb-0 lang-zh"><small class="text-muted">ğŸ’¡ æç¤ºï¼šå¦‚æœçœ‹ä¸åˆ°ç½‘ç»œè¯·æ±‚ï¼Œè¯·å…ˆæ‰“å¼€å¼€å‘è€…å·¥å…·å†è¿›è¡Œç™»å½•æ“ä½œ</small></p>
                            <p class="mb-0 lang-en"><small class="text-muted">ğŸ’¡ Tip: open DevTools before logging in so the requests are recorded.</small></p>
                        </div>
                        
                        <div class="alert alert-info mb-4">
                            <h6 class="lang-zh"><i class="fas fa-info-circle me-2"></i>å›è°ƒURLæ ¼å¼ç¤ºä¾‹ï¼š</h6>
                            <h6 class="lang-en d-none"><i class="fas fa-info-circle me-2"></i>Example callback URL:</h6>
                            <p class="mb-2"><code>giffgaff://auth/callback/?code=ABC123&state=XYZ789</code></p>
                            <p class="mb-0 lang-zh"><small class="text-muted">ç¡®ä¿URLåŒ…å« <code>code</code> å’Œ <code>state</code> å‚æ•°</small></p>
                            <p class="mb-0 lang-en"><small class="text-muted">Make sure the URL includes the <code>code</code> and <code>state</code> parameters.</small></p>
                        </div>
                        
                        <div class="btn-group">
                            <button id="oauthLoginBtn" class="btn btn-primary">
                                <i class="fas fa-sign-in-alt me-2"></i>
                                <span class="lang-zh">å¼€å§‹OAuthç™»å½•</span>
                                <span class="lang-en">Start OAuth login</span>
                            </button>
                        </div>
                    
                        <div id="oauthStatus" class="status" role="status" aria-live="polite"></div>
                        
                        <!-- OAuthå›è°ƒå¤„ç†åŒºåŸŸ -->
                        <div id="oauthCallbackSection" class="verification-section">
                            <div class="mb-4">
                                <label for="callbackUrl" class="form-label">å›è°ƒURLï¼š</label>
                                <textarea id="callbackUrl" class="form-control" placeholder="ä¾‹å¦‚ï¼šgiffgaff://auth/callback/?code=EDXgE_Uq5Q96LT5s&state=7piz0IXfUIHHoxMURfaboQ" rows="3"></textarea>
                            </div>
                            
                            <div class="btn-group">
                                <button id="processCallbackBtn" class="btn btn-primary">
                                    <i class="fas fa-check me-2"></i> å¤„ç†å›è°ƒ
                                </button>
                            </div>
                            
                            <div id="callbackStatus" class="status mt-4" role="status" aria-live="polite"></div>
                        </div>
                    </div>
                    
                    <!-- Cookieç™»å½•åŒºåŸŸ -->
                    <div id="cookieLoginSection" class="mt-4" style="display: none;">
                        <h5 class="mb-3">Cookie ç™»å½•</h5>
                        
                        <div class="alert alert-info mb-4">
                            <h6><i class="fas fa-info-circle me-2"></i>å¦‚ä½•è·å–Cookieï¼š</h6>
                            <ol class="mb-2">
                                <li><strong>è®¿é—®</strong> <a href="https://www.giffgaff.com" target="_blank" rel="noopener">giffgaff.com</a> å¹¶ç™»å½•æ‚¨çš„è´¦æˆ·</li>
                                <li><strong>æ‰“å¼€å¼€å‘è€…å·¥å…·</strong>ï¼ˆChromeï¼šF12 æˆ– å³é”®â†’æ£€æŸ¥ï¼‰</li>
                                <li>åˆ‡æ¢åˆ° <strong>Application</strong>ï¼ˆåº”ç”¨ï¼‰/ <strong>Storage</strong>ï¼ˆå­˜å‚¨ï¼‰æ ‡ç­¾é¡µ</li>
                                <li>åœ¨å·¦ä¾§é€‰æ‹© <strong>Cookies</strong> â†’ <code>https://www.giffgaff.com</code></li>
                                <li>å¤åˆ¶å³ä¾§æ‰€æœ‰æ¡ç›®ï¼Œæ‹¼æˆ <code>name=value; name2=value2; ...</code> æ ¼å¼</li>
                            </ol>
                            <div class="mt-2">
                                <strong>æˆ–</strong> åœ¨å·²ç™»å½•çš„ <code>giffgaff.com</code> é¡µç­¾ï¼Œæ‰“å¼€æ§åˆ¶å°(Console)ç²˜è´´ä»¥ä¸‹ä»£ç å¹¶å›è½¦ï¼š
                                <pre id="cookieConsoleSnippet" class="mt-2 p-2 bg-light border rounded" style="white-space:pre-wrap;word-break:break-all;">
;(() => {
  try {
    const out = document.cookie.split('; ').filter(Boolean).join('; ');
    console.log(out);
    if (navigator.clipboard && window.isSecureContext) {
      navigator.clipboard.writeText(out)
        .then(() => console.log('Cookie å·²å¤åˆ¶åˆ°å‰ªè´´æ¿'))
        .catch(() => {});
    }
  } catch (e) {
    console.log('è¯»å– Cookie å¤±è´¥:', e);
  }
})();
                                </pre>
                                <div class="text-end mt-2">
                                    <button id="copyConsoleSnippetBtn" type="button" class="btn btn-sm btn-warning text-dark">
                                        <i class="fas fa-copy me-1"></i> å¤åˆ¶ä¸Šæ–¹ä»£ç 
                                    </button>
                                </div>
                            </div>
                            <div class="alert alert-warning p-2 mt-2">
                                <small>
                                    <i class="fas fa-exclamation-triangle me-1"></i>
                                    å®‰å…¨æç¤ºï¼šä»…åœ¨å¯ä¿¡è®¾å¤‡ä¸Šç²˜è´´ Cookieã€‚æœ¬å·¥å…·ä¸ä¼šå­˜å‚¨æ‚¨çš„ Cookieã€‚
                                </small>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label for="cookieInput" class="form-label">Cookie å­—ç¬¦ä¸²ï¼š</label>
                            <textarea id="cookieInput" class="form-control" placeholder="è¾“å…¥å®Œæ•´çš„Cookieå­—ç¬¦ä¸²" rows="4"></textarea>
                        </div>
                        
                        <div class="btn-group">
                            <button id="verifyCookieBtn" class="btn btn-warning">
                                <i class="fas fa-check-circle me-2"></i> éªŒè¯Cookie
                            </button>
                        </div>
                        
                        <div id="cookieStatus" class="status"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ­¥éª¤2: é‚®ä»¶éªŒè¯ -->
        <div id="step2" class="section reveal">
            <div class="card card-elevated">
                <div class="card-header">
                    <i class="fas fa-envelope"></i> ç¬¬äºŒæ­¥ï¼šéªŒè¯ç éªŒè¯ï¼ˆé‚®ä»¶/çŸ­ä¿¡ï¼‰
                </div>
                <div class="card-body">
                    <p class="mb-4" style="font-size: 17px; color: #212529;">
                        æˆ‘ä»¬éœ€è¦å‘é€éªŒè¯ç åˆ°æ‚¨çš„é‚®ç®±æˆ–æ‰‹æœºè¿›è¡Œèº«ä»½éªŒè¯ï¼š
                    </p>

                    <div class="row g-3 align-items-end mb-2">
                        <div class="col-sm-6">
                            <label for="mfaChannelSelect" class="form-label">éªŒè¯ç æ¥æ”¶æ–¹å¼</label>
                            <select id="mfaChannelSelect" class="form-select">
                                <option value="EMAIL" selected>é‚®ç®±ï¼ˆEMAILï¼‰</option>
                                <option value="TEXT">çŸ­ä¿¡ï¼ˆTEXTï¼‰</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="btn-group">
                        <button id="sendEmailBtn" class="btn btn-primary">
                            <i class="fas fa-paper-plane me-2"></i> å‘é€éªŒè¯ç 
                        </button>
                    </div>
                    
                    <div id="emailStatus" class="status" role="status" aria-live="polite"></div>
                    
                    <!-- éªŒè¯ç è¾“å…¥åŒºåŸŸ -->
                    <div id="emailVerificationSection" class="verification-section">
                        <p class="mb-4" style="font-size: 17px; color: #212529; margin-top: 25px;">
                            è¯·æ£€æŸ¥æ‚¨çš„é‚®ç®±æˆ–çŸ­ä¿¡å¹¶è¾“å…¥æ”¶åˆ°çš„6ä½éªŒè¯ç ï¼š
                        </p>
                        
                        <div class="mb-4">
                            <label for="emailCode" class="form-label">éªŒè¯ç ï¼š</label>
                            <input type="text" id="emailCode" class="form-control" placeholder="è¾“å…¥6ä½éªŒè¯ç " maxlength="6">
                        </div>
                        
                        <div class="btn-group">
                            <button id="verifyEmailBtn" class="btn btn-primary">
                                <i class="fas fa-check me-2"></i> éªŒè¯éªŒè¯ç 
                            </button>
                        </div>
                        
                        <div id="emailVerifyStatus" class="status mt-4" role="status" aria-live="polite"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ­¥éª¤3: è·å–ä¼šå‘˜ä¿¡æ¯ -->
        <div id="step3" class="section reveal">
            <div class="card card-elevated">
                <div class="card-header">
                    <i class="fas fa-user"></i> ç¬¬ä¸‰æ­¥ï¼šè·å–ä¼šå‘˜ä¿¡æ¯
                </div>
                <div class="card-body">
                    <p class="mb-4" style="font-size: 17px; color: #212529;">
                        è·å–æ‚¨çš„Giffgaffä¼šå‘˜ä¿¡æ¯ï¼š
                    </p>
                    
                    <div class="btn-group">
                        <button id="getMemberBtn" class="btn btn-primary">
                            <i class="fas fa-user-circle me-2"></i> è·å–ä¼šå‘˜ä¿¡æ¯
                        </button>
                    </div>
                    
                    <div id="memberStatus" class="status" role="status" aria-live="polite"></div>
                    <div id="memberInfo" class="mt-4"></div>
                </div>
            </div>
        </div>
        
        <!-- æ­¥éª¤4: ç”³è¯·eSIM -->
        <div id="step4" class="section reveal">
            <div class="card card-elevated">
                <div class="card-header">
                    <i class="fas fa-sim-card"></i> ç¬¬å››æ­¥ï¼šç”³è¯·/æ¿€æ´» eSIM
                </div>
                <div class="card-body">
                    <p class="mb-4" style="font-size: 17px; color: #212529;">
                        è¯·é€‰æ‹©ä¸€ç§æ–¹å¼å®Œæˆ eSIM æ¿€æ´»ï¼š
                    </p>
                    
                    <div class="row row-cols-1 row-cols-md-2 g-3">
                        <div class="col">
                            <div id="manualActivateCard" class="card h-100" style="cursor:not-allowed; opacity: 0.6;" role="button" tabindex="-1" aria-label="æ‰‹åŠ¨æ¿€æ´»ï¼ˆå·²åœç”¨ï¼‰">
                                <div class="card-body text-center">
                                    <i class="fas fa-hand-point-up fa-2x mb-2"></i>
                                    <h5 class="fw-bold">æ‰‹åŠ¨æ¿€æ´»</h5>
                                    <p class="small text-muted mb-0">é¢„è®¢ç©º SIM åï¼Œå‰å¾€å®˜ç½‘æ‰‹åŠ¨ç¡®è®¤æ¿€æ´»ã€‚</p>
                                    <div class="text-center mt-3 badge-spacer">
                                        <span class="badge bg-danger badge-pill-cta" style="pointer-events: none;">æš‚åœä½¿ç”¨</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div id="smsActivateCard" class="card h-100" style="cursor:pointer;" role="button" tabindex="0" aria-label="é€‰æ‹©çŸ­ä¿¡éªŒè¯ç æ¿€æ´»">
                                <div class="card-body text-center">
                                    <i class="fas fa-sms fa-2x mb-2"></i>
                                    <h5 class="fw-bold">çŸ­ä¿¡éªŒè¯ç æ¿€æ´»</h5>
                                    <p class="small text-muted mb-0">ç³»ç»Ÿå°†è‡ªåŠ¨å®Œæˆé¢„è®¢ä¸æ¿€æ´»ã€‚</p>
                                    <div class="text-center mt-3 badge-spacer">
                                        <span class="badge bg-success text-white badge-pill-cta">âœ“ æ¨èä½¿ç”¨</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- çŸ­ä¿¡æ¿€æ´»å†…è”åŒºåŸŸ -->
                    <div id="smsInlineSection" style="display:none;">
                        <div class="card card-body mt-3">
                            <div class="d-flex justify-content-between align-items-end flex-wrap gap-3">
                                <div style="min-width:260px;">
                                    <label for="smsInlineChannel" class="form-label">éªŒè¯ç æ¥æ”¶æ–¹å¼</label>
                                    <select id="smsInlineChannel" class="form-select">
                                        <option value="TEXT" selected>çŸ­ä¿¡ï¼ˆTEXTï¼‰</option>
                                    </select>
                                </div>
                                <div>
                                    <button id="smsInlineSendBtn" class="btn btn-primary">
                                        <i class="fas fa-paper-plane me-2"></i> å‘é€éªŒè¯ç 
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div id="smsInlineStatus" class="status mt-2" role="status" aria-live="polite"></div>
                        
                        <div id="smsCodeInputSection" class="mt-3" style="display:none;">
                            <div style="max-width:420px;">
                                <label for="smsInlineCode" class="form-label">çŸ­ä¿¡éªŒè¯ç </label>
                                <input id="smsInlineCode" type="text" class="form-control" placeholder="è¾“å…¥6ä½éªŒè¯ç " maxlength="6" />
                            </div>
                            <div class="btn-group mt-3">
                                <button id="smsInlineVerifyBtn" class="btn btn-primary">
                                    <i class="fas fa-check me-2"></i> éªŒè¯å¹¶ç»§ç»­æ¿€æ´»
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- æ‰‹åŠ¨æ¿€æ´»åŒºå— -->
                    <div id="manualBlock" class="mt-3" style="display:none;">
                        <div class="btn-group">
                            <button id="reserveESimBtn" class="btn btn-primary">
                                <i class="fas fa-bookmark me-2"></i> é¢„è®¢eSIM
                            </button>
                        </div>

                        <!-- å·²æœ‰æ¿€æ´»ç å¿«æ·å…¥å£ -->
                        <div class="mt-3">
                            <button id="manualEsimInputToggle" class="btn btn-link p-0" type="button">
                                æˆ‘å·²å®Œæˆé¢„å®šeSIMç”³è¯·ï¼ˆå·²æœ‰æ¿€æ´»ç /SSNï¼‰
                            </button>
                            <div id="manualEsimInputSection" class="card card-body mt-2" style="display: none;">
                                <a href="https://www.giffgaff.com/activate" target="_blank" class="btn btn-link p-0 ms-2 mb-3" style="font-size: 0.9rem;">
                                    å‰å¾€æ¿€æ´»é¡µé¢
                                </a>
                                <div class="row g-2">
                                    <div class="col-md-6">
                                        <label for="manualActivationCode" class="form-label">æ¿€æ´»ç </label>
                                        <input id="manualActivationCode" class="form-control" placeholder="å¦‚ï¼šY6GKL6" />
                                    </div>
                                    <div class="col-md-6">
                                        <label for="manualSSN" class="form-label">SSN</label>
                                        <input id="manualSSN" class="form-control" placeholder="å¦‚ï¼š8944â€¦" />
                                    </div>
                                </div>
                                <button id="manualSaveAndNextBtn" class="btn btn-success mt-3" type="button">
                                    <i class="fas fa-check me-2"></i>ä¿å­˜å¹¶è¿›å…¥ä¸‹ä¸€æ­¥
                                </button>
                            </div>
                        </div>

                        <div id="esimReserveStatus" class="status mt-2" role="status" aria-live="polite"></div>

                        <!-- eSIMä¿¡æ¯æ˜¾ç¤ºåŒºåŸŸ -->
                        <div id="esimInfoDisplay" class="mt-4" style="display: none;">
                            <div class="card border-warning">
                                <div class="card-header bg-warning text-dark">
                                    <i class="fas fa-exclamation-triangle me-2"></i>
                                    <strong>é‡è¦ï¼šeSIMå·²é¢„è®¢æˆåŠŸï¼Œè¯·ç«‹å³æ‰‹åŠ¨æ¿€æ´»</strong>
                                </div>
                                <div class="card-body">
                                    <div class="alert alert-danger">
                                        <i class="fas fa-warning me-2"></i>
                                        <strong>è¯·ä¿æŒæ­¤ç½‘é¡µå¼€å¯çŠ¶æ€ï¼</strong>
                                    </div>
                                    
                                    <h5 class="text-success mb-3 text-center" id="esimStatusTitle">æ‚¨çš„eSIMä¿¡æ¯</h5>
                                    <div class="row text-center">
                                        <div class="col-md-6">
                                            <p class="mb-2"><strong>æ¿€æ´»ç :</strong></p>
                                            <div class="border p-3 mb-3 bg-light">
                                                <code id="displayActivationCode" class="text-break fs-4"></code>
                                                <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyTextFromCode('displayActivationCode', this)">
                                                    <i class="fas fa-copy"></i> å¤åˆ¶
                                                </button>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <p class="mb-2"><strong>SSN:</strong></p>
                                            <div class="border p-3 mb-3 bg-light">
                                                <code id="displaySSN" class="text-break fs-5"></code>
                                                <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyTextFromCode('displaySSN', this)">
                                                    <i class="fas fa-copy"></i> å¤åˆ¶
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mt-4">
                                        <button id="confirmActivationBtn" class="btn btn-success btn-lg">
                                            <i class="fas fa-check-circle me-2"></i>æˆ‘å·²å®Œæˆæ‰‹åŠ¨æ¿€æ´»ï¼Œç»§ç»­ä¸‹ä¸€æ­¥
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ­¥éª¤5: è·å–eSIM -->
        <div id="step5" class="section reveal">
            <div class="card card-elevated">
                <div class="card-header">
                    <i class="fas fa-qrcode"></i> ç¬¬äº”æ­¥ï¼šè·å–eSIMäºŒç»´ç 
                </div>
                <div class="card-body">
                    <p class="mb-4" style="font-size: 17px; color: #212529;">
                        è·å–æ‚¨çš„eSIMä¸‹è½½ä»£ç å’ŒäºŒç»´ç ï¼š
                    </p>
                    
                    <div class="btn-group">
                        <button id="getESimTokenBtn" class="btn btn-primary">
                            <i class="fas fa-download me-2"></i> è·å–eSIM Token
                        </button>
                    </div>
                    
                    <div id="tokenStatus" class="status" role="status" aria-live="polite"></div>
                    
                    <!-- eSIMç»“æœæ˜¾ç¤º -->
                    <div id="resultContainer" class="mt-4">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-qrcode me-2"></i> æ‚¨çš„eSIMä¿¡æ¯
                            </div>
                            <div class="card-body text-center">
                                <div id="qrcode" class="mt-4"></div>
                                <div id="esimInfo" class="mt-4"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
 
    <!-- å¤–éƒ¨è„šæœ¬ -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- å…¥åœºåŠ¨æ•ˆ -->
    <script>
        (function(){
            const initReveal = () => {
                const nodes = document.querySelectorAll('.reveal');
                if (!nodes.length) return;
                if ('IntersectionObserver' in window) {
                    const io = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                entry.target.classList.add('show');
                                io.unobserve(entry.target);
                            }
                        });
                    }, { rootMargin: '0px 0px -10% 0px', threshold: 0.1 });
                    nodes.forEach(el => io.observe(el));
                } else {
                    nodes.forEach(el => el.classList.add('show'));
                }
            };
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initReveal, { once: true });
            } else {
                initReveal();
            }
        })();
    </script>
    
    <!-- Cloudflare Turnstile -->
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
    <script>
        (function initInvisibleTurnstile() {
            var siteKey = (window && window.TURNSTILE_SITE_KEY) || '0x4AAAAAABqjeVscZAiqB11B';
            function boot() {
                try {
                    if (!window.turnstile || !siteKey) { setTimeout(boot, 300); return; }
                    var c = document.createElement('div');
                    c.style.display = 'none';
                    c.setAttribute('aria-hidden', 'true');
                    document.body.appendChild(c);
                    var isExecuting = false;
                    var hasExecuted = false;
                    var markIdle = function() { isExecuting = false; };
                    var exec = function() {
                        if (!window.turnstile || isExecuting) { return; }
                        isExecuting = true;
                        if (hasExecuted) { try { window.turnstile.reset(id); } catch (_) {} }
                        hasExecuted = true;
                        try { window.turnstile.execute(id); } catch (e) { markIdle(); }
                    };
                    var id = window.turnstile.render(c, {
                        sitekey: siteKey,
                        size: 'invisible',
                        callback: function (token) { window.__cfTurnstileToken = token; markIdle(); },
                        'error-callback': markIdle,
                        'timeout-callback': markIdle,
                        'expired-callback': function () { markIdle(); exec(); }
                    });
                    exec();
                    setInterval(function () {
                        if (document.visibilityState === 'hidden') { return; }
                        exec();
                    }, 110000);
                } catch (e) { setTimeout(boot, 500); }
            }
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', boot);
            } else {
                boot();
            }
        })();
    </script>
    
    <!-- æ€§èƒ½ä¼˜åŒ–è„šæœ¬ -->
    <script src="/src/js/performance.js"></script>
    
    <!-- å›½é™…åŒ–åˆå§‹åŒ– -->
    <script type="module">
        import { initI18n } from '/src/js/modules/i18n.js';
        initI18n('giffgaff');
    </script>
    
    <!-- ä¸»åº”ç”¨è„šæœ¬ï¼ˆæ¨¡å—åŒ–ï¼‰ -->
    <script type="module" src="/src/giffgaff/js/giffgaff-app.js"></script>
    
    <!-- ç»Ÿä¸€ç‰ˆæƒé¡µè„š -->
    <script type="module" src="/src/js/bootstrap-footer.js"></script>
</body>
</html>
